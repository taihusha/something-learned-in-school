<wxs module="JSON">
module.exports = {
    stringify : function(item,label){
      item.choose=label
      return JSON.stringify(item)
    }
}
</wxs>

<!-- 渲染普通的单项数据 -->
<template name="radio">
  <view class="container">
    <view class='indent'>
      <radio-group wx:if="{{!isWenda}}" bindchange="tapRadio" style="margin-left: 70rpx">
        <block wx:for="{{item.options}}" wx:for-item="subItem" wx:key="index">
          <label class="{{subItem.checked}}" data-option="{{[subItem,index,idx]}}">
            <radio value="{{JSON.stringify(item,subItem.label)}}" hidden='true'/>
            <text class="label_text">
              {{subItem.label}}. {{subItem.text}}
            </text>
          </label>
        </block>      
      </radio-group>
    </view>
  </view>
</template>

<!-- 渲染普通的多选数据 -->
<template name="checkbox">
  <view class="container">
    <block wx:if="{{!isWenda}}" wx:for="{{item.options}}" wx:for-item="subItem" wx:key="index">
      <view wx:if="{{subItem.checked}}">
        <button class="list_tapped" data-option="{{[subItem,index,idx]}}" bindtap="tapCheckbox">
          <text class="list_text">
            {{subItem.label}}. {{subItem.text}}
          </text>
        </button>
      </view>
      <view wx:if="{{!subItem.checked}}">
        <button class="list" data-option="{{[subItem,index,idx]}}" bindtap="tapCheckbox">
          <text class="list_text">
            {{subItem.label}}. {{subItem.text}}
          </text>
        </button>
      </view>
    </block>
  </view>
</template>

<!-- 题目选择模层 -->
<template name="layer">
  <scroll-view class="status-lists" scroll-y="true">
    <block wx:for="{{allList}}" wx:key="index">
      <view bindtap="setActiveNum" data-option="{{index}}" wx:if="{{item.isAnswer == 0}}" class="status-list {{answers.activeNum == index?'active':''}}">{{index+1}}</view>
      <view bindtap="setActiveNum" data-option="{{index}}" wx:if="{{item.isAnswer == 1}}" class="status-list success  {{answers.activeNum == index?'active':''}}">{{index+1}}</view>
    </block>
    <view class="submit" hover-class='submit_tapped' bindtap="tapConfirm">提交</view>
  </scroll-view>

</template>

<!-- 页面题目模板 -->
<template name="question">
  <view class="header" >
    <view wx:if="{{item.s != ''}}">{{item.s}}</view>
    <view>{{item.q}}</view>
  </view>
  <template wx:if="{{item.type == '单选'}}" is="radio" data="{{item,idx}}" />
  <template wx:else is="checkbox" data="{{item,idx,isWenda}}" />
  <view class="space">　</view>
</template>
<!-- 题目展示页面 -->
<template name="question-list">
  <view class="navibar"/>
  <cover-view class="bg_panel" style="opacity:{{0.7}}">
    <image class="background" src="/pages/res/62740716_p1.png" mode="aspectFill"></image>
  </cover-view>
  <view class='top'>
    <view class="xuanz">
      <view wx:for="{{allList}}" wx:for-index="idx" wx:key="idx">
        <view wx:if="{{idx==swiper.active-1}}" class='swiper-list prev'>
          <view hidden="true">{{idx+1}}/{{allList.length}} {{item.type}}</view>
        </view>
        <view wx:if="{{idx==swiper.active}}" class='swiper-list'>
          <view>{{idx+1}}/{{allList.length}} {{item.type}}</view>
        </view>
        <view wx:if="{{idx==swiper.active+1}}" class='swiper-list next'>
          <view hidden="true">{{idx+1}}/{{allList.length}} {{item.type}}</view>
        </view>
      </view>
    </view>
    <image class='icon' src='/pages/res/timg.png' mode="aspectFill"></image>
    <view wx:if="{{countDownSecond>9}}" class='countDown'>{{countDownMin}}:{{countDownSecond}}</view>
    <view wx:if="{{countDownSecond<10}}" class='countDown'>{{countDownMin}}:0{{countDownSecond}}</view>
  </view>
  <scroll-view scroll-y="true" class='swiper-lists' bind:touchend='touchEnd' bind:touchstart='setEvent'>
    <view wx:for="{{allList}}" wx:for-index="idx" wx:key="idx">
      <view wx:if="{{idx == swiper.active-1}}" class='swiper-list prev' animation="{{swiper.animationPre}}">
        <template is="question" data="{{idx,item,answers,allList,layerlayer,isWenda}}" />
      </view>
      <view wx:if="{{idx == swiper.active}}" class='swiper-list' animation="{{swiper.animationT}}">
        <template is="question" data="{{idx,item,answers,allList,layerlayer,isWenda}}" />
      </view>
      <view wx:if="{{idx == swiper.active+1}}" class='swiper-list next' animation="{{swiper.animationNext}}">
        <template is="question" data="{{idx,item,answers,allList,layerlayer,isWenda}}" />
      </view>
    </view>
  </scroll-view>
 
  <view hidden="{{!layerlayer.isLayerShow}}" class="footer-layer" bindtap="layerFooterClick"></view>
  <view class="footer" animation="{{layerlayer.layerAnimation}}">
    <view class="count">
      <view class="collect active" wx:if="{{allList[answers.activeNum].isStore==true}}" bindtap="collectList">收藏</view>
      <view class="collect" wx:else bindtap="collectList">收藏</view>
      <view class="processpage">
        <view class="page" bindtap='pageClick'>{{answers.activeNum + 1}}/{{allList.length}}</view>
        <view wx:if="{{answers.activeNum+1<10}}">
        <view class="process_container">
        <view class="process" hover-class='process_tapped' bindtap='pageClick'>
          <view class="process" wx:if="{{answers.activeNum==0}}">
            <view class="status_none"/>
            <view class="status_none"/>
            <view class="status_none"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+3].isAnswer}}"/>
          </view>
          <view class="process" wx:if="{{answers.activeNum==1}}">
            <view class="status_none"/>
            <view class="status_none"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+3].isAnswer}}"/>
          </view>
          <view class="process" wx:if="{{answers.activeNum==2}}">
            <view class="status_none"/>
            <view class="status_{{allList[answers.activeNum-2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+3].isAnswer}}"/>
          </view>
          <view class="process" wx:if="{{answers.activeNum==allList.length-3}}">
            <view class="status_{{allList[answers.activeNum-3].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+2].isAnswer}}"/>
            <view class="status_none"/>
          </view>
          <view class="process" wx:if="{{answers.activeNum==allList.length-2}}">
            <view class="status_{{allList[answers.activeNum-3].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_none"/>
            <view class="status_none"/>
          </view>
          <view class="process" wx:if="{{answers.activeNum==allList.length-1}}">
            <view class="status_{{allList[answers.activeNum-3].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_none"/>
            <view class="status_none"/>
            <view class="status_none"/>
          </view>
          <view class="process" wx:if="{{(answers.activeNum>=3)&(answers.activeNum<=allList.length-4)}}">
            <view class="status_{{allList[answers.activeNum-3].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+3].isAnswer}}"/>
          </view>
        </view>
        </view>
        </view>
        <view wx:if="{{answers.activeNum+1>9}}">
        <view class="process_container_right">
        <view class="process" hover-class='process_tapped' bindtap='pageClick'>
          <view class="process" wx:if="{{answers.activeNum==0}}">
            <view class="status_none"/>
            <view class="status_none"/>
            <view class="status_none"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+3].isAnswer}}"/>
          </view>
          <view class="process" wx:if="{{answers.activeNum==1}}">
            <view class="status_none"/>
            <view class="status_none"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+3].isAnswer}}"/>
          </view>
          <view class="process" wx:if="{{answers.activeNum==2}}">
            <view class="status_none"/>
            <view class="status_{{allList[answers.activeNum-2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+3].isAnswer}}"/>
          </view>
          <view class="process" wx:if="{{answers.activeNum==allList.length-3}}">
            <view class="status_{{allList[answers.activeNum-3].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+2].isAnswer}}"/>
            <view class="status_none"/>
          </view>
          <view class="process" wx:if="{{answers.activeNum==allList.length-2}}">
            <view class="status_{{allList[answers.activeNum-3].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_none"/>
            <view class="status_none"/>
          </view>
          <view class="process" wx:if="{{answers.activeNum==allList.length-1}}">
            <view class="status_{{allList[answers.activeNum-3].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_none"/>
            <view class="status_none"/>
            <view class="status_none"/>
          </view>
          <view class="process" wx:if="{{(answers.activeNum>=3)&(answers.activeNum<=allList.length-4)}}">
            <view class="status_{{allList[answers.activeNum-3].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum-1].isAnswer}}"/>
            <view class="status_current_{{allList[answers.activeNum].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+1].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+2].isAnswer}}"/>
            <view class="status_{{allList[answers.activeNum+3].isAnswer}}"/>
          </view>
        </view>
        </view>
        </view>
      </view>
    </view>
    <template is="layer" data="{{answers,allList,layerlayer}}" />
  </view>
</template>
